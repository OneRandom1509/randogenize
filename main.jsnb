{
  "metadata": {
    "name": "New JSNB",
    "language_info": {
      "name": "JavaScipt",
      "version": "8.0"
    }
  },
  "jsnbversion": "v0.1",
  "cells": [
    {
      "code": "// API stuff\nconst TRIVIA_API = 'https://opentdb.com/api.php?amount=1&type=multiple';\nconst GEMINI_API = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-pro:generateContent';\nconst API_KEY = '{GEMINI_API_KEY}';\n\n// Game state\nlet quiz = null;\nlet score = 0;\nlet botAnswer = null;\nlet questionCount = 0;\nlet timer = null;\nlet timeLeft = 20;\nconst MAX_QUESTIONS = 10;\nconst TIME_PER_QUESTION = 20;\n\nasync function getNewQuestion() {\n    if (questionCount >= MAX_QUESTIONS) {\n        showFinalScore();\n        return;\n    }\n\n    // Remove the start button if it exists\n    const startButton = document.querySelector('.start');\n    if (startButton) {\n        startButton.remove();\n    }\n\n    const response = await fetch(TRIVIA_API);\n    const data = await response.json();\n    if (data && data.results && data.results.length > 0) {\n        quiz = data.results[0];\n        questionCount++;\n        showQuestion(quiz);\n        getBotAnswer(quiz);\n        startTimer();\n    } else {\n        alert(\"Couldn't get a question. Try again!\");\n    }\n}\n\n\nfunction startTimer() {\n    // Clear any existing timer\n    if (timer) clearInterval(timer);\n    \n    timeLeft = TIME_PER_QUESTION;\n    updateTimerDisplay();\n    \n    timer = setInterval(() => {\n        timeLeft--;\n        updateTimerDisplay();\n        \n        if (timeLeft <= 0) {\n            clearInterval(timer);\n            timeUp();\n        }\n    }, 1000);\n}\n\nfunction updateTimerDisplay() {\n    const timerElement = document.getElementById('timer');\n    if (timerElement) {\n        timerElement.textContent = `Time left: ${timeLeft}s`;\n        // Make timer red when less than 5 seconds\n        timerElement.style.color = timeLeft <= 5 ? 'red' : 'green';\n    }\n}\n\nfunction timeUp() {\n    alert(\"Time's up! Moving to next question...\");\n    getNewQuestion();\n}\n\nfunction showQuestion(quiz) {\n    document.getElementById(\"question-box\").innerHTML = `\n        <div class=\"question-header\">\n            <h2>${quiz.question}</h2>\n            <div id=\"timer\" class=\"timer\">Time left: ${TIME_PER_QUESTION}s</div>\n            <div class=\"progress\">Question ${questionCount} of ${MAX_QUESTIONS}</div>\n        </div>\n        <ul id=\"choices\">\n            ${[...quiz.incorrect_answers, quiz.correct_answer]\n                .sort(() => Math.random() - 0.5) \n                .map((choice, index) => \n                    `<li>\n                        <button onclick=\"checkAnswer('${choice}')\">${choice}</button>\n                    </li>`\n                ).join('')}\n        </ul>\n        <div class=\"buttons\">\n            <button onclick=\"showHint()\" title=\"Get hint\">Need a Hint? ‚ùì</button>\n            <button onclick=\"showBotAnswer()\" title=\"See bot answer\">See Bot's Answer ü§ñ</button>\n        </div>\n        <div id=\"hint-box\" style=\"display: none;\"></div>\n    `;\n}\n\nfunction makePrompt(question, choices, mode = 'answer') {\n    if (mode === 'answer') {\n        return `Help me with this multiple choice question:\nQuestion: ${question}\nChoices: ${choices.join(', ')}\nJust give me the best answer and a fun fact about this question's topic too.`;\n    } else {\n        return `Help me understand this question:\nQuestion: ${question}\nChoices: ${choices.join(', ')}\nGive a very slight hint, one line`;\n    }\n}\n\nasync function askBot(prompt) {\n    try {\n        const response = await fetch(`${GEMINI_API}?key=${API_KEY}`, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                contents: [{\n                    parts: [{\n                        text: prompt\n                    }]\n                }]\n            })\n        });\n\n        const data = await response.json();\n        return data.candidates[0].content.parts[0].text;\n    } catch (error) {\n        console.error('Bot error:', error);\n        return 'Bot is taking a coffee break, try again!';\n    }\n}\n\nasync function getBotAnswer(quiz) {\n    const choices = [...quiz.incorrect_answers, quiz.correct_answer];\n    const prompt = makePrompt(quiz.question, choices, 'answer');\n    botAnswer = await askBot(prompt);\n}\n\nfunction showBotAnswer() {\n    const hintBox = document.getElementById('hint-box');\n    hintBox.style.display = 'block';\n    hintBox.innerHTML = `<div class=\"bot-answer\">\n        <h3>Bot says:</h3>\n        <p>${botAnswer || 'Thinking...'}</p>\n    </div>`;\n}\n\nasync function showHint() {\n    const choices = [...quiz.incorrect_answers, quiz.correct_answer];\n    const prompt = makePrompt(quiz.question, choices, 'hint');\n    const hint = await askBot(prompt);\n    \n    const hintBox = document.getElementById('hint-box');\n    hintBox.style.display = 'block';\n    hintBox.innerHTML = `<div class=\"hint\">\n        <h3>Hint:</h3>\n        <p>${hint}</p>\n    </div>`;\n}\n\nfunction checkAnswer(picked) {\n    clearInterval(timer); // Stop the timer when answer is selected\n    if (picked === quiz.correct_answer) {\n        score += 10;\n        alert(\"You got it! üéâ\");\n    } else {\n        score -= 5;\n        alert(\"Nope, try again! üòÖ\");\n    }\n    updateScore();\n    getNewQuestion();\n}\n\nfunction updateScore() {\n    document.getElementById(\"score\").innerText = `Score: ${score}`;\n}\n\nfunction showFinalScore() {\n    clearInterval(timer); // Make sure to clear timer at game end\n    let message;\n    if (score >= 80) {\n        message = \"You're the king of Randogenize!! üéâ\";\n    } else if (score >= 60) {\n        message = \"Awesome job! üëç\";\n    } else if (score >= 40) {\n        message = \"Nice one! üôÇ\";\n    } else if (score >= 20) {\n        message = \"Give some effort! üòê\";\n    } else if (score > 0) {\n        message = \"Not smart enough!? üòÖ\";\n    } else {\n        message = \"Give up boy! üò¨\";\n    }\n\n    document.getElementById(\"question-box\").innerHTML = `\n        <h2>Game Over!</h2>\n        <p>Your final score is: ${score}</p>\n        <p>You completed ${questionCount} questions</p>\n        <h3>${message}</h3>\n        <button onclick=\"restartGame()\" class=\"restart-btn\">Play Again</button>\n    `;\n}\n\nfunction restartGame() {\n    score = 0;\n    questionCount = 0;\n    clearInterval(timer);\n    updateScore();\n    getNewQuestion();\n}\n\ndocument.body.innerHTML = `\n    <div class=\"game\">\n        <h1>Randogenize!</h1>\n        <div id=\"score\">Score: 0</div>\n        <div id=\"question-box\"></div>\n        <button onclick=\"getNewQuestion()\" class=\"start\">Let's Go!</button>\n    </div>\n    <style>\n        .game {\n            max-width: 800px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n        .question-header {\n            margin-bottom: 20px;\n        }\n        .timer {\n            font-size: 1.2em;\n            font-weight: bold;\n            margin: 10px 0;\n        }\n        .progress {\n            color: #666;\n            margin-bottom: 15px;\n        }\n        .buttons {\n            display: flex;\n            gap: 10px;\n            margin-top: 20px;\n        }\n        .bot-answer, .hint {\n            margin-top: 20px;\n            padding: 15px;\n            background-color: #f5f5f5;\n            border-radius: 5px;\n        }\n        .bot-answer h3, .bot-answer p, .hint h3, .hint p {\n            color: #1b5e20;\n        }\n        #choices {\n            list-style: none;\n            padding: 0;\n        }\n        #choices button {\n            width: 100%;\n            margin: 5px 0;\n            padding: 10px;\n        }\n        .start, .restart-btn {\n            margin-top: 20px;\n            padding: 10px 20px;\n            font-size: 1.1em;\n        }\n    </style>\n`;",
      "status": "[-]",
      "output": "<p class=\"error\">missing ) after argument list</p>",
      "type": "code"
    }
  ],
  "source": "https://github.com/gopi-suvanam/jsnb",
  "run_on_load": false
}
